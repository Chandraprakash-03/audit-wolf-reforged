-- Migration to add 'security' vulnerability type
-- This migration updates the CHECK constraint on the vulnerabilities table to include 'security' type

-- Drop the existing CHECK constraint
ALTER TABLE public.vulnerabilities DROP CONSTRAINT IF EXISTS vulnerabilities_type_check;

-- Add the new CHECK constraint with 'security' included
ALTER TABLE public.vulnerabilities ADD CONSTRAINT vulnerabilities_type_check 
    CHECK (type IN ('reentrancy', 'overflow', 'access_control', 'gas_optimization', 'best_practice', 'security'));